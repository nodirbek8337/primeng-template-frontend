<div class="datatable-card card mt-1">
    <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h4 *ngIf="tableTitle">{{ tableTitle }}</h4>
            <div class="d-flex gap-2">
                <button *ngIf="hasRefreshBtn" pButton icon="pi pi-refresh" (click)="triggerRefresh()"></button>
                <button *ngIf="hasCreate" pButton icon="pi pi-plus" label="Add" (click)="triggerAdd()"></button>
            </div>
        </div>

        <ng-content select="[filter]"></ng-content>

        <p-table
            [value]="value"
            [columns]="columnDefs"
            [paginator]="true"
            [rows]="rows"
            [totalRecords]="totalRecords"
            [rowsPerPageOptions]="rowsPerPageOptions"
            [loading]="loading"
            [lazy]="true"
            (onLazyLoad)="loadData($event)"
            (onRowClick)="handleRowClick($event)"
            dataKey="id"
        >
            <ng-template pTemplate="header" let-columns>
                <tr>
                    <th *ngFor="let col of columns" [pSortableColumn]="col.sortable !== false ? col.field : null">
                        {{ col.header }}
                        <p-sortIcon *ngIf="col.sortable !== false" [field]="col.field"></p-sortIcon>
                    </th>
                </tr>
                <tr>
                    <th *ngFor="let col of columns">
                        <input *ngIf="col.searchable !== false" pInputText type="text" class="w-100" placeholder="Search {{ col.header }}" (input)="onColumnFilter($any($event.target).value, col.field)" />
                    </th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-rowData let-columns="columns">
                <tr>
                    <td *ngFor="let col of columns">
                        {{ rowData[col.field] }}
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>
</div>
